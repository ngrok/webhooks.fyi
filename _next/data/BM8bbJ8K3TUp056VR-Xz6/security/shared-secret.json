{"pageProps":{"markdoc":{"content":[{"$$mdtype":"Tag","name":"table","attributes":{},"children":[{"$$mdtype":"Tag","name":"thead","attributes":{},"children":[]},{"$$mdtype":"Tag","name":"tbody","attributes":{},"children":[{"$$mdtype":"Tag","name":"tr","attributes":{},"children":[{"$$mdtype":"Tag","name":"td","attributes":{},"children":[{"$$mdtype":"Tag","name":"strong","attributes":{},"children":["Complexity"]}]},{"$$mdtype":"Tag","name":"td","attributes":{},"children":[{"$$mdtype":"Tag","name":"ul","attributes":{},"children":[{"$$mdtype":"Tag","name":"li","attributes":{},"children":["Very Low"]}]}]}]},{"$$mdtype":"Tag","name":"tr","attributes":{},"children":[{"$$mdtype":"Tag","name":"td","attributes":{},"children":[{"$$mdtype":"Tag","name":"strong","attributes":{},"children":["Pros"]}]},{"$$mdtype":"Tag","name":"td","attributes":{},"children":[{"$$mdtype":"Tag","name":"ul","attributes":{},"children":[{"$$mdtype":"Tag","name":"li","attributes":{},"children":["Authentication with Low Complexity"]}]}]}]},{"$$mdtype":"Tag","name":"tr","attributes":{},"children":[{"$$mdtype":"Tag","name":"td","attributes":{},"children":[{"$$mdtype":"Tag","name":"strong","attributes":{},"children":["Caveats"]}]},{"$$mdtype":"Tag","name":"td","attributes":{},"children":[{"$$mdtype":"Tag","name":"ul","attributes":{},"children":[{"$$mdtype":"Tag","name":"li","attributes":{},"children":["No message integrity and confidentiality controls"]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":["Requires HTTPS to keep credentials secret"]}]}]}]},{"$$mdtype":"Tag","name":"tr","attributes":{},"children":[{"$$mdtype":"Tag","name":"td","attributes":{},"children":[{"$$mdtype":"Tag","name":"strong","attributes":{},"children":["Examples"]}]},{"$$mdtype":"Tag","name":"td","attributes":{},"children":[{"$$mdtype":"Tag","name":"ul","attributes":{},"children":[{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"a","attributes":{"href":"https://docs.datadoghq.com/integrations/webhooks/#authentication"},"children":["Datadog"]}]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"a","attributes":{"href":"https://developers.docusign.com/platform/webhooks/connect/validation-and-security/"},"children":["DocuSign"]}]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"a","attributes":{"href":"https://docs.mparticle.com/integrations/webhook/event/"},"children":["mParticle"]}]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"a","attributes":{"href":"https://developer.okta.com/docs/concepts/event-hooks/#one-time-verification-request"},"children":["Okta Event Hooks"]}]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"a","attributes":{"href":"https://docs.vmware.com/en/VMware-Workspace-ONE-UEM/services/System_Settings_On_Prem/GUID-AWT-SYSTEM-ADVANCED-API-NOTIF.html"},"children":["VMWare WorkspaceOne"]}]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"a","attributes":{"href":"https://marketplace.zoom.us/docs/guides/build/webhook-only-app"},"children":["Zoom"]}]}]}]}]}]}]},{"$$mdtype":"Tag","name":"hr","attributes":{},"children":[]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["In our research, 10% of the webhook providers use Shared Secrets — in the form of Basic Authentication, shared credentials, bearer tokens, or a verification token — for authentication. In this method, the webhook provider and listener share a common secret used exclusively to authenticate webhook requests:"]},{"$$mdtype":"Tag","name":"ol","attributes":{},"children":[{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":["On webhook requests, the provider sends a webhook notification containing the message plus a shared secret in a pre-defined header variable or the Authorization header using the Basic Auth format ( ",{"$$mdtype":"Tag","name":"code","attributes":{},"children":["Authorization: Basic <\"username:password\" in base64>"]}," ):"]},{"$$mdtype":"Tag","name":"Fence","attributes":{"language":"js"},"children":["app.post('/webhook', (req, res) => {\n  \n  // get authorization header (Basic <value>)\n  const b64auth = (req.headers.authorization || '').split('Basic ')[1] || ''\n  // Get login and password\n  const [login, password] = Buffer.from(b64auth, 'base64').toString().split(':')\n\n  // Verify login and password are and correct\n  if (login && password && \n      login === process.env.WEBHOOK_LOGIN && \n      password === process.env.WEBHOOK_PW) {\n    // Webhook Authenticated \n    // process and respond...\n    res.json({ message: \"Success\" })\n  }else{\n    res.status(401).send('Authentication required.')\n  }\n})\n"]}]},{"$$mdtype":"Tag","name":"li","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":["The webhook listener validates the value in the request versus the shared secret. Only requests with the correct secret are processed."]}]}]},{"$$mdtype":"Tag","name":"DiagramSharedSecret","attributes":{},"children":[]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[{"$$mdtype":"Tag","name":"em","attributes":{},"children":["Basic Authentication, or shared credentials, or verification token on webhook requests"]}]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["This security method addresses only the webhook service authentication and does not implement any control on message integrity. Even with HTTPS, the shared secret is processed in clear text, increasing the risk of the secret getting compromised."]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["Therefore, their use should be avoided in production or used only with compensatory controls — such as IP Restrictions and callback requests — to mitigate risks."]},{"$$mdtype":"Tag","name":"Callout","attributes":{"title":"Note","type":"note"},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":["Some services offer basic auth as a quick option for development and unit testing, alongside more robust security controls for production usage. ",{"$$mdtype":"Tag","name":"a","attributes":{"href":"https://developers.docusign.com/platform/webhooks/connect/validation-and-security/"},"children":["DocuSign"]},", for example, offers basic authentication, Request Signatures with HMAC and Mutual TLS, and encourages the use of HMAC and mTLS in production use-cases."]}]}],"frontmatter":{"title":"Shared Secret","description":"Learn how webhook providers implement shared secrets — Basic Authentication, Shared Credentials, or Verification Tokens — to secure webhook communications."},"file":{"path":"/security/shared-secret.md"}}},"__N_SSG":true}